<!doctype html>
<meta charset="utf-8" />
<title>Demo of interactive content in canvas</title>

<style>
  canvas {
    border: 1px solid blue;
    width: 638px;
    height: 318px;
  }
  form p {
    margin: 6px;
  }
</style>

<canvas id="canvas" width="638" height="318" layoutsubtree="true">
  <div id=drawElement style="width: 578px; height: 318;" >
    <form id="demo-form" action="#" method="get">
      <fieldset>
        <legend>ðŸš€ Spaceship Control Panel</legend>
        <p>
          <label for="shipName">Ship Name:</label>
          <input type="text" id="shipName" value="The 'Canvas' Voyager">
        </p>
        <p>
          <input type="checkbox" id="hyperdrive" checked>
          <label for="hyperdrive">Engage Hyperdrive</label>
        </p>
        <fieldset>
          <legend>Target System</legend>
          <p>
            <input type="radio" id="alpha" name="system" value="alpha" checked>
            <label for="alpha">Alpha Centauri</label>
          </p>
          <p>
            <input type="radio" id="beta" name="system" value="beta">
            <label for="beta">Betelgeuse</label>
          </p>
        </fieldset>
        <p>
          <label for="shieldLevel">Shield Strength:</label>
          <input type="range" id="shieldLevel" min="0" max="100" value="75">
        </p>
        <p style="text-align: right; margin: 0;">
          <button type="submit">Launch!</button>
        </p>
      </fieldset>
    </form>
  </div>
</canvas>
<script>
  const ctx = document.getElementById('canvas').getContext('2d');

  function draw() {
    ctx.reset();
    let x = 30 * devicePixelRatio;
    let y = 30 * devicePixelRatio;
    if (typeof ctx.drawElementImage === 'function') {
      ctx.drawElementImage(drawElement, x, y);
    } else {
      ctx.drawElement(drawElement, x, y);
    }
    rect = drawElement.getBoundingClientRect();
    ctx.setHitTestRegions([
      {
        element: drawElement,
        rect: {x: x, y: y, width: rect.width * devicePixelRatio,
        height: rect.height * devicePixelRatio}
      }
    ]);
  }

  onload = () => {
    const resizeObserver = new ResizeObserver((entries) => {
      const entry = entries.find((entry) => entry.target === canvas);
      canvas.width = entry.devicePixelContentBoxSize[0].inlineSize;
      canvas.height = entry.devicePixelContentBoxSize[0].blockSize;
      draw();
    });
    // See: https://web.dev/articles/device-pixel-content-box
    resizeObserver.observe(canvas, {box: ['device-pixel-content-box'],
      fireOnEveryPaint: true});
  }
</script>


